# RVASec 2024 - Consumer Routers Still Suck

## Slides
link

## References

### Prior Works of Art / News Stories Mentioned

TP-Link WAN-Side Vulnerability CVE-2023-1389 Added to the MIRAI Botnet Arsenal (Peter Girnus, Trend Micro’s ZDI, April 2023)
- [https://www.zerodayinitiative.com/blog/2023/4/21/tp-link-wan-side-vulnerability-cve-2023-1389-added-to-the-mirai-botnet-arsenal](https://www.zerodayinitiative.com/blog/2023/4/21/tp-link-wan-side-vulnerability-cve-2023-1389-added-to-the-mirai-botnet-arsenal)
<br>
  
PwnAgent: A One-Click WAN-side RCE in Netgear RAX Routers with CVE-2023-24749 (Zion Leonahenahe Basque, @mahaloz, February 2023)
- [https://mahaloz.re/2023/02/25/pwnagent-netgear.html](https://mahaloz.re/2023/02/25/pwnagent-netgear.html)  
<br>

Cool Vulns Don’t Live Long - NETGEAR and Pwn2Own (Kevin Denis, Synacktiv, December 2022) 
- [https://www.synacktiv.com/en/publications/cool-vulns-dont-live-long-netgear-and-pwn2own.html](https://www.synacktiv.com/en/publications/cool-vulns-dont-live-long-netgear-and-pwn2own.html)
<br>

Realtek-based routers, smart devices are being gobbled up by a voracious botnet (Pieter Arntz, Malwarebytes, August 2021)
- [https://www.malwarebytes.com/blog/news/2021/08/realtek-based-routers-smart-devices-are-being-gobbled-up-by-a-voracious-botnet](https://www.malwarebytes.com/blog/news/2021/08/realtek-based-routers-smart-devices-are-being-gobbled-up-by-a-voracious-botnet)
<br>

Mirai Botnet Attack IoT Devices via CVE-2020-5902
- [https://www.trendmicro.com/en_us/research/20/g/mirai-botnet-attack-iot-devices-via-cve-2020-5902.html](https://www.trendmicro.com/en_us/research/20/g/mirai-botnet-attack-iot-devices-via-cve-2020-5902.html)
<br>

Tracking Mass Vulnerabilities in IoT (Cheryl Biswas, TD Bank, April 2023)
- [https://atlseccon2023.sched.com/event/1IAiX/tracking-mass-vulnerabilities-in-iot](https://atlseccon2023.sched.com/event/1IAiX/tracking-mass-vulnerabilities-in-iot)
<br>

Cloudy with a Chance of Hacking All the Wireless Things (Vangelis Stykas, PenTestPartners, September 2020)
- [https://www.pentestpartners.com/security-blog/cloudy-with-a-chance-of-hacking-all-the-wireless-things/](https://www.pentestpartners.com/security-blog/cloudy-with-a-chance-of-hacking-all-the-wireless-things/)
- https://stykas.com/gwn-cloud/
<br>

Exploring the Hidden Attack Surface of OEM IoT Devices (FaradaySec, August 2022)
- https://github.com/infobyte/cve-2022-27255/blob/main/DEFCON/slides.pdf  
<br>

More than 100000 Wireless Routers have Default Backdoor (Mohit Kumar, April 2012)
- https://thehackernews.com/2012/04/more-than-100000-wireless-routers-have.html
<br>

Arris / Arris-variant DSL/Fiber Router Critical Vulnerability Exposure (Derek Abdine, July 2022)
- https://derekabdine.com/blog/2022-arris-advisory.html
<br>

CVE-2022-31793: Arris Routers and Muhttpd (Censys, August 2022)
- [https://censys.com/cve-2022-31793-arris-routers-and-muhttpd/](https://censys.com/cve-2022-31793-arris-routers-and-muhttpd/)
<br>

Advisory: Multiple issues in Realtek SDK affect hundreds of thousands of devices down the supply chain (OneKey, August 2021)
- [https://onekey.com/blog/advisory-multiple-issues-realtek-sdk-iot-supply-chain/](https://onekey.com/blog/advisory-multiple-issues-realtek-sdk-iot-supply-chain/)
<br>

Finite State Supply Chain Assessment
 - [https://dd80b675424c132b90b3-e48385e382d2e5d17821a5e1d8e4c86b.ssl.cf1.rackcdn.com/external/finite-state-sca1-final.pdf](https://dd80b675424c132b90b3-e48385e382d2e5d17821a5e1d8e4c86b.ssl.cf1.rackcdn.com/external/finite-state-sca1-final.pdf)
<br>

Volt Typhoon Targets US Critical Infrastructure with Living Off the Land Techniques
- [https://www.microsoft.com/en-us/security/blog/2023/05/24/volt-typhoon-targets-us-critical-infrastructure-with-living-off-the-land-techniques/](https://www.microsoft.com/en-us/security/blog/2023/05/24/volt-typhoon-targets-us-critical-infrastructure-with-living-off-the-land-techniques/)
<br>

ZuoRAT is a sophisticated malware that mainly targets SOHO routers
- [https://www.malwarebytes.com/blog/news/2022/06/zuorat-is-a-sophisticated-malware-that-mainly-targets-soho-routers](https://www.malwarebytes.com/blog/news/2022/06/zuorat-is-a-sophisticated-malware-that-mainly-targets-soho-routers)
<br>

The Path to the Cloud is Filled with Holes: Exploiting 4G Edge Routers (Noam Moshe, October 2023)
- [https://claroty.com/team82/research/the-path-to-the-cloud-is-filled-with-holes-exploiting-4g-edge-routers](https://claroty.com/team82/research/the-path-to-the-cloud-is-filled-with-holes-exploiting-4g-edge-routers)
<br>

Triple Threat: Breaking Teltonika Routers Three Ways (Noam Moshe, Roni Gavrilov-OTORIO, May 2023)
- [https://claroty.com/team82/research/triple-threat-breaking-teltonika-routers-three-ways](https://claroty.com/team82/research/triple-threat-breaking-teltonika-routers-three-ways)
<br>

The Pumpkin Eclipse (Black Lotus Labs, May 2024)
- [https://blog.lumen.com/the-pumpkin-eclipse/](https://blog.lumen.com/the-pumpkin-eclipse/)
<br>

Your Not so "Home" Office - Soho Hacking at Pwn2Own (Alex Plaskett, MacCaulay Hudson, April 2023)
- https://conference.hitb.org/hitbsecconf2023ams/session/your-not-so-home-office-soho-hacking-at-pwn2own/
<br>

Hacking Millions of Modems (Sam Curry, June 2024)
- [https://samcurry.net/hacking-millions-of-modems](https://samcurry.net/hacking-millions-of-modems)
<br>

Government Stuffs
- https://www.whitehouse.gov/briefing-room/presidential-actions/2021/05/12/executive-order-on-improving-the-nations-cybersecurity/
- https://www.ntia.gov/page/software-bill-materials
- https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-216.pdf
<br>

### Blogs / Whitepapers

NETGEAR Router Network Misconfiguration (Jimi Sebree, Tenable, December 2022)
- [https://medium.com/tenable-techblog/netgear-router-network-misconfiguration-70ac695c81a6](https://medium.com/tenable-techblog/netgear-router-network-misconfiguration-70ac695c81a6)
<br>

TrendNET AC2600 RCE via WAN (Jimi Sebree, Tenable, January 2022)
- [https://medium.com/tenable-techblog/trendnet-ac2600-rce-via-wan-8926b29908a4](https://medium.com/tenable-techblog/trendnet-ac2600-rce-via-wan-8926b29908a4)
<br>

Arris Cable Modem Teardown (Jimi Sebree, Tenable, September 2021)
- [https://medium.com/tenable-techblog/arris-cable-modem-teardown-5e294b7007eb](https://medium.com/tenable-techblog/arris-cable-modem-teardown-5e294b7007eb)
<br>

Rooting Gryphon Routers via Shared VPN (Evan Grant, Tenable, February 2022)
- [https://medium.com/tenable-techblog/rooting-gryphon-routers-via-shared-vpn-a8b133ec3d58](https://medium.com/tenable-techblog/rooting-gryphon-routers-via-shared-vpn-a8b133ec3d58)
<br>

Bypassing Authentication on Arcadyan Routers with CVE-2021-20090 and Rooting Some Buffalo (Evan Grant, Tenable, August 2021)
- [https://medium.com/tenable-techblog/bypassing-authentication-on-arcadyan-routers-with-cve-2021-20090-and-rooting-some-buffalo-ea1dd30980c2](https://medium.com/tenable-techblog/bypassing-authentication-on-arcadyan-routers-with-cve-2021-20090-and-rooting-some-buffalo-ea1dd30980c2)
<br>

Router Vulnerability Present for a Decade: Why IoT Supply  Chain is to Blame (Evan Grant, Tenable, April 2021)
- [https://static.tenable.com/marketing/whitepapers/Whitepaper-Router_Vulnerability_Present_for_a_Decade.pdf](https://static.tenable.com/marketing/whitepapers/Whitepaper-Router_Vulnerability_Present_for_a_Decade.pdf)
<br>

### Relevant Security Advisories

[https://www.tenable.com/security/research/tra-2023-19](https://www.tenable.com/security/research/tra-2023-19)
- Multiple issues in Telstra devices
<br>

NETGEAR RAX30
- [https://www.tenable.com/security/research/tra-2022-36](https://www.tenable.com/security/research/tra-2022-36)
  - Network misconfiguration exposing access from WAN

- [https://www.tenable.com/security/research/tra-2022-37](https://www.tenable.com/security/research/tra-2022-37)
  - Command injection issues
  - Secret backdoor account

- [https://www.tenable.com/security/research/tra-2023-9](https://www.tenable.com/security/research/tra-2023-9)
  - Buffer overflows in CGI endpoints
  - Format string vulnerability in management interface
  - Inadequate CSRF protections
  - File sharing functionality allows symlink attacks and code execution by default

- [https://www.tenable.com/security/research/tra-2023-12](https://www.tenable.com/security/research/tra-2023-12)
  - Firmware upgrade signature check bypass
  - Denial of service via unauthenticated file upload
<br>

NETGEAR R6700
- [https://www.tenable.com/security/research/tra-2021-57](https://www.tenable.com/security/research/tra-2021-57)
  - Command injection vulnerability
  - Ability to modify device configuration
<br>

NETGEAR RAX43
- [https://www.tenable.com/security/research/tra-2021-55](https://www.tenable.com/security/research/tra-2021-55)
  - Buffer overflow leading to command injection
  - Ability to modify configuration
  - Inclusion of known-vulnerable libraries
<br>

TP-Link Archer AX21 (AX1800)
- Command injection vulnerability
- [https://www.tenable.com/security/research/tra-2023-11](https://www.tenable.com/security/research/tra-2023-11)
- [https://www.tp-link.com/us/support/download/archer-ax21/v3/#Firmware](https://www.tp-link.com/us/support/download/archer-ax21/v3/#Firmware)
- [https://www.zerodayinitiative.com/advisories/ZDI-23-451/](https://www.zerodayinitiative.com/advisories/ZDI-23-451/)
- [https://www.zerodayinitiative.com/advisories/ZDI-23-452/](https://www.zerodayinitiative.com/advisories/ZDI-23-452/)
<br>

TrendNET AC2600 TEW-827DRU
- [https://www.tenable.com/security/research/tra-2021-54](https://www.tenable.com/security/research/tra-2021-54)
  - Networking misconfigurations exposing access from WAN
  - Unauthenticated information disclosures
  - Disclosure of Samba credentials
  - Disclosure of FTP credentials
  - Disclosure of arbitrary configurations
  - Authentication bypasses
  - Lack of adequate CSRF protections
  - Ability to modify device configurations and firmware
  - Unauthenticated denial of service
  - Command injection issues
<br>

Gryphon
- [https://www.tenable.com/security/research/tra-2022-12](https://www.tenable.com/security/research/tra-2022-12)
  - Disclosure of customer information

- [https://www.tenable.com/security/research/tra-2021-51](https://www.tenable.com/security/research/tra-2021-51)
  - Command injection issues
  - XSS issues
  - VPN misconfiguration
  - Access to developer infrastructure
<br>

Arcadyan / Buffalo
- [https://www.tenable.com/security/research/tra-2021-13](https://www.tenable.com/security/research/tra-2021-13)
  - Vulnerability information regarding many devices

- [https://kb.cert.org/vuls/id/914124](https://kb.cert.org/vuls/id/914124)
  - 3rd party coverage of the above with tracking information for additional affected vendors
<br>

Arris SurfBoard SB8200
- [https://www.tenable.com/security/research/tra-2021-45](https://www.tenable.com/security/research/tra-2021-45)
  - Lack of CSRF Protection

- [https://www.tenable.com/security/research/tra-2021-49](https://www.tenable.com/security/research/tra-2021-49)
  - Insecure Password Change Utility
<br>
